# æ–‡ä»¶è·¯å¾„: .github/workflows/arcticcloud_renew.yml
name: ArcticCloud VPS è‡ªåŠ¨ç»­æœŸ

äº:
  schedule:
    - cron: '0 12 * * *' # æ¯å¤©ä¸­åˆ12ç‚¹ (UTCæ—¶é—´) è¿è¡Œ
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ

jobs:
  renew_vps:
    name: æ‰§è¡Œ VPS ç»­æœŸ
    runs-on: ubuntu-latest # åœ¨æœ€æ–°çš„ Ubuntu ç¯å¢ƒä¸­è¿è¡Œ

    steps:
      - name: ğŸ›ï¸ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4 # ä½¿ç”¨ actions/checkout@v4 æ£€å‡ºä»“åº“ä»£ç 

      - name: ğŸ è®¾ç½® Python
        uses: actions/setup-python@v5 # ä½¿ç”¨ actions/setup-python@v5 è®¾ç½® Python ç¯å¢ƒ
        with:
          python-version: '3.11' # æŒ‡å®š Python ç‰ˆæœ¬ä¸º 3.11

      - name: â¬‡ï¸ å®‰è£…ä¾èµ–
        run: |
          pip install -r rcticCloud-checkin/requirements.txt # <-- å·²ä¿®æ­£ä¸ºç›´æ¥å¼•ç”¨æ ¹ç›®å½•ä¸‹çš„ requirements.txt

      - name: ğŸš€ è¿è¡Œç­¾åˆ°è„šæœ¬
        env:
          # ArcticCloud è´¦å·ä¿¡æ¯ (å¿…é¡»åœ¨ GitHub Secrets ä¸­è®¾ç½®)
          ARCTIC_USERNAME: ${{ secrets.ARCTIC_USERNAME }}
          ARCTIC_PASSWORD: ${{ secrets.ARCTIC_PASSWORD }}
          
          # è„šæœ¬è¿è¡Œé…ç½® (å¯åœ¨ GitHub Secrets ä¸­è®¾ç½®ï¼Œæˆ–ä½¿ç”¨é»˜è®¤å€¼)
          HEADLESS: ${{ secrets.HEADLESS || 'true' }}          # æ˜¯å¦æ— å¤´æ¨¡å¼è¿è¡Œæµè§ˆå™¨ (é»˜è®¤ä¸º true)
          ARCTIC_LOG_LEVEL: ${{ secrets.ARCTIC_LOG_LEVEL || 'INFO' }} # æ—¥å¿—çº§åˆ« (é»˜è®¤ä¸º INFO)
          
          # é€šçŸ¥é…ç½® (å¯é€‰ï¼Œæ ¹æ®éœ€è¦è®¾ç½®ï¼Œæ‰€æœ‰æ•æ„Ÿä¿¡æ¯éƒ½åº”åœ¨ GitHub Secrets ä¸­è®¾ç½®)
          PUSH_PLUS_TOKEN: ${{ secrets.PUSH_PLUS_TOKEN }}
          PUSH_PLUS_USER: ${{ secrets.PUSH_PLUS_USER }}
          DD_BOT_SECRET: ${{ secrets.DD_BOT_SECRET }}
          DD_BOT_TOKEN: ${{ secrets.DD_BOT_TOKEN }}
          TG_BOT_TOKEN: ${{ secrets.TG_BOT_TOKEN }}
          TG_USER_ID: ${{ secrets.TG_USER_ID }} # Telegram ä¸ªäººç”¨æˆ·ID (å¯é€‰)
          TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }} # Telegram ç¾¤ç»„ID (ç”¨äºç¾¤ç»„é€šçŸ¥)
          WXPUSHER_APP_TOKEN: ${{ secrets.WXPUSHER_APP_TOKEN }}
          
        run: |
          python arcticcloud.py # æ‰§è¡Œä¸» Python è„šæœ¬
